import { sortAgentListToFindBrokerage } from './get-brokrage-name'

describe('sortAgentListToFindBrokerage', () => {
  it('should works when there is inactive office', () => {
    const agentsList: ListingAgent[] = [
      {
        id: '0',
        email: '',
        user_id: '',
        profile_image_url: '',
        cover_image_url: '',
        mlsid: 'XXOCPARKALE',
        fax: null,
        full_name: 'Alex Parker',
        first_name: 'Alex',
        last_name: 'Parker',
        middle_name: '',
        phone_number: '',
        nar_number: '',
        office_mui: 3443911261,
        status: 'Inactive',
        office_mlsid: 'XXMTF',
        work_phone: '',
        generational_name: null,
        matrix_unique_id: 1195965159,
        updated_at: 1639553759.69328,
        deleted_at: null,
        created_at: 1628961684.46683,
        mls: 'CRMLS',
        type: 'agent',
        office_id: '53f9a4b4-f94f-11eb-8ee0-0271a4acc769',
        secret_questions: [],
        office: {
          id: '53f9a4b4-f94f-11eb-8ee0-0271a4acc769',
          type: 'office',
          mls_id: 'MRML',
          name: 'CRMLS',
          long_name: 'CRMLS',
          address: '15325 Fairfield Ranch Road, Suite 200',
          phone: '909-859-2040',
          fax: '909-859-2050',
          city: 'Chino Hills',
          state: 'CA',
          postal_code: '91709',
          license_number: '00000001',
          email: 'NONE@CRMLS.ORG'
        }
      },
      {
        id: '1',
        email: '',
        user_id: '',
        profile_image_url: '',
        cover_image_url: '',
        mlsid: 'OCPARKALE',
        fax: null,
        full_name: 'Alex Parker',
        first_name: 'Alex',
        last_name: 'Parker',
        middle_name: '',
        phone_number: '949.427.1350',
        nar_number: '',
        office_mui: 1421541404,
        status: 'Active',
        office_mlsid: 'OC05850',
        work_phone: '949.427.1350',
        generational_name: null,
        matrix_unique_id: 3945572980,
        updated_at: 1643041685.43417,
        deleted_at: null,
        created_at: 1628540945.87968,
        mls: 'CRMLS',
        type: 'agent',
        office_id: '55b60e96-f94f-11eb-827c-0271a4acc769',
        secret_questions: ['(949) XXX-XX50'],
        office: {
          id: '55b60e96-f94f-11eb-827c-0271a4acc769',
          type: 'office',
          mls_id: 'OC05850',
          name: 'Douglas Elliman of California',
          long_name: 'Douglas Elliman of California',
          address: '28202 Cabot Rd Ste510',
          phone: '949-354-0450',
          fax: '949-354-0450',
          city: 'Laguna Niguel',
          state: 'CA',
          postal_code: '92677',
          license_number: '01947727',
          email: ''
        }
      },
      {
        id: '2',
        email: 'Alex.Parker@Elliman.com',
        mlsid: 'OCPARKALE',
        user_id: '',
        profile_image_url: '',
        cover_image_url: '',
        fax: null,
        full_name: 'Alex Parker',
        first_name: 'Alex',
        last_name: 'Parker',
        middle_name: '',
        phone_number: '949.427.1350',
        nar_number: '',
        office_mui: 469760432,
        status: 'Active',
        office_mlsid: '1334095',
        work_phone: '949-354-0450',
        generational_name: null,
        matrix_unique_id: 3739764429,
        updated_at: 1639621927.67206,
        deleted_at: null,
        created_at: 1631115461.14482,
        mls: 'CLAW',
        type: 'agent',
        office_id: 'b87464ba-0c5f-11ec-8f64-0271a4acc769',
        secret_questions: [
          '(949) XXX-XX50',
          '(949) XXX-XX50',
          'Alex.xxxxxxxxxxxxxn.com'
        ],
        office: {
          id: 'b87464ba-0c5f-11ec-8f64-0271a4acc769',
          type: 'office',
          mls_id: 'OC05850',
          name: 'Douglas Elliman of California',
          long_name: 'Douglas Elliman of California',
          address: '',
          phone: '949-354-0450',
          fax: '949-354-0450',
          city: 'Laguna Niguel',
          state: 'CA',
          postal_code: '92677',
          license_number: '01947727',
          email: ''
        }
      },
      {
        id: '3',
        email: 'Alex.Parker@Elliman.com',
        mlsid: '1036186',
        user_id: '',
        profile_image_url: '',
        cover_image_url: '',
        fax: null,
        full_name: 'Alex Parker',
        first_name: 'Alex',
        last_name: 'Parker',
        middle_name: '',
        phone_number: '(949) 354-0450',
        nar_number: '',
        office_mui: 242476,
        status: 'Active',
        office_mlsid: '242476',
        work_phone: '949-354-0450',
        generational_name: null,
        matrix_unique_id: 1036186,
        updated_at: 1643041637.41336,
        deleted_at: null,
        created_at: 1634077300.35511,
        mls: 'MLSL',
        type: 'agent',
        office_id: '7ac47886-2bb2-11ec-8253-0271a4acc769',
        secret_questions: ['(949) XXX-XX50', 'Alex.xxxxxxxxxxxxxn.com'],
        office: {
          id: '7ac47886-2bb2-11ec-8253-0271a4acc769',
          type: 'office',
          mls_id: '242476',
          name: 'Douglas Elliman of California',
          long_name: '',
          address: '',
          phone: '949-354-0450',
          fax: '',
          city: 'Laguna Niguel',
          state: '5',
          postal_code: '',
          license_number: '',
          email: ''
        }
      }
    ]

    const actual = sortAgentListToFindBrokerage(agentsList, 'CRMLS')
    const expected = [
      agentsList[1],
      agentsList[3],
      agentsList[2],
      agentsList[0]
    ]
    expect(actual).toStrictEqual(expected)
  })

  it('should works when there is null office', () => {
    const agentsList: ListingAgent[] = [
      {
        id: '0',
        email: '',
        user_id: '',
        profile_image_url: '',
        cover_image_url: '',
        mlsid: 'XXOCPARKALE',
        fax: null,
        full_name: 'Alex Parker',
        first_name: 'Alex',
        last_name: 'Parker',
        middle_name: '',
        phone_number: '',
        nar_number: '',
        office_mui: 3443911261,
        status: null,
        office_mlsid: 'XXMTF',
        work_phone: '',
        generational_name: null,
        matrix_unique_id: 1195965159,
        updated_at: 1639553759.69328,
        deleted_at: null,
        created_at: 1628961684.46683,
        mls: 'CRMLS',
        type: 'agent',
        office_id: '53f9a4b4-f94f-11eb-8ee0-0271a4acc769',
        secret_questions: [],
        office: {
          id: '53f9a4b4-f94f-11eb-8ee0-0271a4acc769',
          type: 'office',
          mls_id: 'MRML',
          name: 'CRMLS',
          long_name: 'CRMLS',
          address: '15325 Fairfield Ranch Road, Suite 200',
          phone: '909-859-2040',
          fax: '909-859-2050',
          city: 'Chino Hills',
          state: 'CA',
          postal_code: '91709',
          license_number: '00000001',
          email: 'NONE@CRMLS.ORG'
        }
      },
      {
        id: '1',
        email: '',
        user_id: '',
        profile_image_url: '',
        cover_image_url: '',
        mlsid: 'OCPARKALE',
        fax: null,
        full_name: 'Alex Parker',
        first_name: 'Alex',
        last_name: 'Parker',
        middle_name: '',
        phone_number: '949.427.1350',
        nar_number: '',
        office_mui: 1421541404,
        status: 'Active',
        office_mlsid: 'OC05850',
        work_phone: '949.427.1350',
        generational_name: null,
        matrix_unique_id: 3945572980,
        updated_at: 1643041685.43417,
        deleted_at: null,
        created_at: 1628540945.87968,
        mls: 'CRMLS',
        type: 'agent',
        office_id: '55b60e96-f94f-11eb-827c-0271a4acc769',
        secret_questions: ['(949) XXX-XX50'],
        office: {
          id: '55b60e96-f94f-11eb-827c-0271a4acc769',
          type: 'office',
          mls_id: 'OC05850',
          name: 'Douglas Elliman of California',
          long_name: 'Douglas Elliman of California',
          address: '28202 Cabot Rd Ste510',
          phone: '949-354-0450',
          fax: '949-354-0450',
          city: 'Laguna Niguel',
          state: 'CA',
          postal_code: '92677',
          license_number: '01947727',
          email: ''
        }
      },
      {
        id: '2',
        email: 'Alex.Parker@Elliman.com',
        mlsid: 'OCPARKALE',
        user_id: '',
        profile_image_url: '',
        cover_image_url: '',
        fax: null,
        full_name: 'Alex Parker',
        first_name: 'Alex',
        last_name: 'Parker',
        middle_name: '',
        phone_number: '949.427.1350',
        nar_number: '',
        office_mui: 469760432,
        status: 'Active',
        office_mlsid: '1334095',
        work_phone: '949-354-0450',
        generational_name: null,
        matrix_unique_id: 3739764429,
        updated_at: 1639621927.67206,
        deleted_at: null,
        created_at: 1631115461.14482,
        mls: 'CLAW',
        type: 'agent',
        office_id: 'b87464ba-0c5f-11ec-8f64-0271a4acc769',
        secret_questions: [
          '(949) XXX-XX50',
          '(949) XXX-XX50',
          'Alex.xxxxxxxxxxxxxn.com'
        ],
        office: {
          id: 'b87464ba-0c5f-11ec-8f64-0271a4acc769',
          type: 'office',
          mls_id: 'OC05850',
          name: 'Douglas Elliman of California',
          long_name: 'Douglas Elliman of California',
          address: '',
          phone: '949-354-0450',
          fax: '949-354-0450',
          city: 'Laguna Niguel',
          state: 'CA',
          postal_code: '92677',
          license_number: '01947727',
          email: ''
        }
      },
      {
        id: '3',
        email: 'Alex.Parker@Elliman.com',
        mlsid: '1036186',
        user_id: '',
        profile_image_url: '',
        cover_image_url: '',
        fax: null,
        full_name: 'Alex Parker',
        first_name: 'Alex',
        last_name: 'Parker',
        middle_name: '',
        phone_number: '(949) 354-0450',
        nar_number: '',
        office_mui: 242476,
        status: 'Active',
        office_mlsid: '242476',
        work_phone: '949-354-0450',
        generational_name: null,
        matrix_unique_id: 1036186,
        updated_at: 1643041637.41336,
        deleted_at: null,
        created_at: 1634077300.35511,
        mls: 'MLSL',
        type: 'agent',
        office_id: '7ac47886-2bb2-11ec-8253-0271a4acc769',
        secret_questions: ['(949) XXX-XX50', 'Alex.xxxxxxxxxxxxxn.com'],
        office: {
          id: '7ac47886-2bb2-11ec-8253-0271a4acc769',
          type: 'office',
          mls_id: '242476',
          name: 'Douglas Elliman of California',
          long_name: '',
          address: '',
          phone: '949-354-0450',
          fax: '',
          city: 'Laguna Niguel',
          state: '5',
          postal_code: '',
          license_number: '',
          email: ''
        }
      }
    ]

    const actual = sortAgentListToFindBrokerage(agentsList, 'CRMLS')
    const expected = [
      agentsList[1],
      agentsList[3],
      agentsList[2],
      agentsList[0]
    ]
    expect(actual).toStrictEqual(expected)
  })

  it('should works when all status are null', () => {
    const agentsList: ListingAgent[] = [
      {
        id: '0',
        email: 'Alex.Parker@Elliman.com',
        mlsid: 'OCPARKALE',
        user_id: '',
        profile_image_url: '',
        cover_image_url: '',
        fax: null,
        full_name: 'Alex Parker',
        first_name: 'Alex',
        last_name: 'Parker',
        middle_name: '',
        phone_number: '949.427.1350',
        nar_number: '',
        office_mui: 469760432,
        status: null,
        office_mlsid: '1334095',
        work_phone: '949-354-0450',
        generational_name: null,
        matrix_unique_id: 3739764429,
        updated_at: 1639621927.67206,
        deleted_at: null,
        created_at: 1631115461.14482,
        mls: 'CLAW',
        type: 'agent',
        office_id: 'b87464ba-0c5f-11ec-8f64-0271a4acc769',
        secret_questions: [
          '(949) XXX-XX50',
          '(949) XXX-XX50',
          'Alex.xxxxxxxxxxxxxn.com'
        ],
        office: {
          id: 'b87464ba-0c5f-11ec-8f64-0271a4acc769',
          type: 'office',
          mls_id: 'OC05850',
          name: 'Douglas Elliman of California',
          long_name: 'Douglas Elliman of California',
          address: '',
          phone: '949-354-0450',
          fax: '949-354-0450',
          city: 'Laguna Niguel',
          state: 'CA',
          postal_code: '92677',
          license_number: '01947727',
          email: ''
        }
      },
      {
        id: '1',
        email: 'Alex.Parker@Elliman.com',
        mlsid: '1036186',
        user_id: '',
        profile_image_url: '',
        cover_image_url: '',
        fax: null,
        full_name: 'Alex Parker',
        first_name: 'Alex',
        last_name: 'Parker',
        middle_name: '',
        phone_number: '(949) 354-0450',
        nar_number: '',
        office_mui: 242476,
        status: null,
        office_mlsid: '242476',
        work_phone: '949-354-0450',
        generational_name: null,
        matrix_unique_id: 1036186,
        updated_at: 1643041637.41336,
        deleted_at: null,
        created_at: 1634077300.35511,
        mls: 'MLSL',
        type: 'agent',
        office_id: '7ac47886-2bb2-11ec-8253-0271a4acc769',
        secret_questions: ['(949) XXX-XX50', 'Alex.xxxxxxxxxxxxxn.com'],
        office: {
          id: '7ac47886-2bb2-11ec-8253-0271a4acc769',
          type: 'office',
          mls_id: '242476',
          name: 'Douglas Elliman of California',
          long_name: '',
          address: '',
          phone: '949-354-0450',
          fax: '',
          city: 'Laguna Niguel',
          state: '5',
          postal_code: '',
          license_number: '',
          email: ''
        }
      },
      {
        id: '2',
        email: '',
        user_id: '',
        profile_image_url: '',
        cover_image_url: '',
        mlsid: 'XXOCPARKALE',
        fax: null,
        full_name: 'Alex Parker',
        first_name: 'Alex',
        last_name: 'Parker',
        middle_name: '',
        phone_number: '',
        nar_number: '',
        office_mui: 3443911261,
        status: null,
        office_mlsid: 'XXMTF',
        work_phone: '',
        generational_name: null,
        matrix_unique_id: 1195965159,
        updated_at: 1639553759.69328,
        deleted_at: null,
        created_at: 1628961684.46683,
        mls: 'CRMLS',
        type: 'agent',
        office_id: '53f9a4b4-f94f-11eb-8ee0-0271a4acc769',
        secret_questions: [],
        office: {
          id: '53f9a4b4-f94f-11eb-8ee0-0271a4acc769',
          type: 'office',
          mls_id: 'MRML',
          name: 'CRMLS',
          long_name: 'CRMLS',
          address: '15325 Fairfield Ranch Road, Suite 200',
          phone: '909-859-2040',
          fax: '909-859-2050',
          city: 'Chino Hills',
          state: 'CA',
          postal_code: '91709',
          license_number: '00000001',
          email: 'NONE@CRMLS.ORG'
        }
      },
      {
        id: '3',
        email: '',
        user_id: '',
        profile_image_url: '',
        cover_image_url: '',
        mlsid: 'OCPARKALE',
        fax: null,
        full_name: 'Alex Parker',
        first_name: 'Alex',
        last_name: 'Parker',
        middle_name: '',
        phone_number: '949.427.1350',
        nar_number: '',
        office_mui: 1421541404,
        status: null,
        office_mlsid: 'OC05850',
        work_phone: '949.427.1350',
        generational_name: null,
        matrix_unique_id: 3945572980,
        updated_at: 1643041685.43417,
        deleted_at: null,
        created_at: 1628540945.87968,
        mls: 'CRMLS',
        type: 'agent',
        office_id: '55b60e96-f94f-11eb-827c-0271a4acc769',
        secret_questions: ['(949) XXX-XX50'],
        office: {
          id: '55b60e96-f94f-11eb-827c-0271a4acc769',
          type: 'office',
          mls_id: 'OC05850',
          name: 'Douglas Elliman of California',
          long_name: 'Douglas Elliman of California',
          address: '28202 Cabot Rd Ste510',
          phone: '949-354-0450',
          fax: '949-354-0450',
          city: 'Laguna Niguel',
          state: 'CA',
          postal_code: '92677',
          license_number: '01947727',
          email: ''
        }
      }
    ]

    const actual = sortAgentListToFindBrokerage(agentsList, 'CRMLS')
    const expected = [
      agentsList[3],
      agentsList[2],
      agentsList[1],
      agentsList[0]
    ]
    expect(actual).toStrictEqual(expected)
  })

  it('should works with real user data', () => {
    const agentsList = [
      {
        id: '2a214c22-be18-11eb-b13c-0aa41e28002f',
        email: 'aimee.fink@elliman.com',
        mlsid: 'RBNY-66509',
        fax: null,
        full_name: 'Aimee Fink',
        first_name: 'Aimee',
        last_name: 'Fink',
        middle_name: null,
        phone_number: null,
        nar_number: null,
        office_mui: '1448558654',
        status: null,
        office_mlsid: 'RPLU-1',
        work_phone: null,
        generational_name: null,
        matrix_unique_id: '4175185854',
        updated_at: 1631201940.33955,
        deleted_at: null,
        created_at: 1622029656.02499,
        mls: 'REBNY',
        license_number: null,
        designation: null,
        nrds: null,
        type: 'agent',
        office_id: '6eb4063e-be0b-11eb-b314-0aa41e28002f',
        phone_numbers: null,
        secret_questions: ['aimeexxxxxxxxxxxxn.com'],
        office: {
          id: '6eb4063e-be0b-11eb-b314-0aa41e28002f',
          type: 'office',
          mls_id: 'RBNY-51',
          name: 'Douglas Elliman Real Estate',
          long_name: 'Douglas Elliman Real Estate',
          address: null,
          phone: '(212) 891-7000',
          fax: null,
          city: null,
          state: null,
          postal_code: null,
          license_number: null,
          email: null,
          address_line2: '',
          full_address: '',
          mls: 'REBNY'
        }
      },
      {
        id: '5b338af4-be0f-11eb-b8c5-0aa41e28002f',
        email: 'aimee.fink@elliman.com',
        mlsid: 'RBNY-66509',
        fax: null,
        full_name: 'Aimee Fink',
        first_name: 'Aimee',
        last_name: 'Fink',
        middle_name: null,
        phone_number: null,
        nar_number: null,
        office_mui: '191609821',
        status: 'Active',
        office_mlsid: 'RBNY-51',
        work_phone: null,
        generational_name: null,
        matrix_unique_id: '1522631409',
        updated_at: 1634761393.85783,
        deleted_at: null,
        created_at: 1622025872.88236,
        mls: 'REBNY',
        license_number: null,
        designation: null,
        nrds: null,
        type: 'agent',
        office_id: '4188b966-be0b-11eb-819d-0aa41e28002f',
        phone_numbers: null,
        secret_questions: ['aimeexxxxxxxxxxxxn.com'],
        office: {
          id: '4188b966-be0b-11eb-819d-0aa41e28002f',
          type: 'office',
          mls_id: 'RBNY-51',
          name: 'Douglas Elliman Real Estate',
          long_name: 'Douglas Elliman Real Estate',
          address: '575 Madison Avenue',
          phone: '(212) 891-7000',
          fax: null,
          city: 'New York',
          state: 'NY',
          postal_code: '10022',
          license_number: null,
          email: null,
          address_line2: 'New York NY 10022',
          full_address: '575 Madison Avenue New York NY 10022',
          mls: 'REBNY'
        }
      },
      {
        id: '8ee83eca-1185-11ec-8a2d-0271a4acc769',
        email: 'aimee.fink@elliman.com',
        mlsid: 'RBNY-66509',
        fax: null,
        full_name: 'Aimee Fink',
        first_name: 'Aimee',
        last_name: 'Fink',
        middle_name: null,
        phone_number: null,
        nar_number: null,
        office_mui: '1448558654',
        status: null,
        office_mlsid: 'RPLU-1',
        work_phone: null,
        generational_name: null,
        matrix_unique_id: '1723556552',
        updated_at: 1633155515.55499,
        deleted_at: null,
        created_at: 1631202586.75504,
        mls: 'REBNY',
        license_number: null,
        designation: null,
        nrds: null,
        type: 'agent',
        office_id: '6eb4063e-be0b-11eb-b314-0aa41e28002f',
        phone_numbers: null,
        secret_questions: ['aimeexxxxxxxxxxxxn.com'],
        office: {
          id: '6eb4063e-be0b-11eb-b314-0aa41e28002f',
          type: 'office',
          mls_id: 'RBNY-51',
          name: 'Douglas Elliman Real Estate',
          long_name: 'Douglas Elliman Real Estate',
          address: null,
          phone: '(212) 891-7000',
          fax: null,
          city: null,
          state: null,
          postal_code: null,
          license_number: null,
          email: null,
          address_line2: '',
          full_address: '',
          mls: 'REBNY'
        }
      },
      {
        id: '93d90408-be17-11eb-a5eb-0aa41e28002f',
        email: 'aimee.fink@elliman.com',
        mlsid: 'RBNY-66509',
        fax: null,
        full_name: 'Aimee Fink',
        first_name: 'Aimee',
        last_name: 'Fink',
        middle_name: null,
        phone_number: '(646) 841-3224',
        nar_number: null,
        office_mui: '1620378035',
        status: null,
        office_mlsid: 'PDES-89',
        work_phone: '(212) 705-1064',
        generational_name: null,
        matrix_unique_id: '4243688723',
        updated_at: 1631203209.74207,
        deleted_at: null,
        created_at: 1622029403.89305,
        mls: 'REBNY',
        license_number: null,
        designation: null,
        nrds: null,
        type: 'agent',
        office_id: '936bf220-be0b-11eb-9f90-0aa41e28002f',
        secret_questions: [
          '(212) XXX-XX64',
          '(646) XXX-XX24',
          'aimeexxxxxxxxxxxxn.com'
        ],
        office: {
          id: '936bf220-be0b-11eb-9f90-0aa41e28002f',
          type: 'office',
          mls_id: 'RBNY-51',
          name: 'Elliman',
          long_name: 'Elliman',
          address: null,
          phone: '(212) 350-8500',
          fax: null,
          city: null,
          state: null,
          postal_code: null,
          license_number: null,
          email: null,
          address_line2: '',
          full_address: '',
          mls: 'REBNY'
        }
      },
      {
        id: 'b8f375c6-be11-11eb-865e-0aa41e28002f',
        email: 'afink@bondnewyork.com',
        mlsid: 'RBNY-66509',
        fax: null,
        full_name: 'Aimee Fink',
        first_name: 'Aimee',
        last_name: 'Fink',
        middle_name: null,
        phone_number: '(646) 841-3224',
        nar_number: null,
        office_mui: '2784619547',
        status: null,
        office_mlsid: 'OLRS-3022',
        work_phone: '(212) 582-2009',
        generational_name: null,
        matrix_unique_id: '1237238900',
        updated_at: 1622026889.16167,
        deleted_at: null,
        created_at: 1622026889.16167,
        mls: 'REBNY',
        license_number: 'OLRS-87571',
        designation: null,
        nrds: null,
        type: 'agent',
        office_id: '36cbb9ce-be0b-11eb-9eca-0aa41e28002f',
        secret_questions: [
          '(212) XXX-XX09',
          '(646) XXX-XX24',
          'afinkxxxxxxxxxxxk.com'
        ],
        office: {
          id: '36cbb9ce-be0b-11eb-9eca-0aa41e28002f',
          type: 'office',
          mls_id: 'RBNY-5339',
          name: 'Bond New York',
          long_name: 'Bond New York',
          address: null,
          phone: '(212) 582-2009',
          fax: null,
          city: 'New York',
          state: 'NY',
          postal_code: '10019',
          license_number: null,
          email: null,
          address_line2: 'New York NY 10019',
          full_address: 'New York NY 10019',
          mls: 'REBNY'
        }
      }
    ] as ListingAgent[]

    const actual = sortAgentListToFindBrokerage(agentsList, 'REBNY')
    const expected = [
      agentsList[1],
      agentsList[4], 
      agentsList[3],
      agentsList[2],
      agentsList[0]
    ]
    expect(actual).toStrictEqual(expected)
  })
})
